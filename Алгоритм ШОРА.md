### **Алгоритм Шора**

Алгоритм Шора — это квантовый алгоритм для факторизации целых чисел, который экспоненциально быстрее классических методов. Он позволяет разложить число NN на простые множители за полиномиальное время, используя квантовые вычисления. Основные этапы:

---

#### **1. Классическая подготовка**

- **Выбор случайного числа aa:**  
    Выберите aa в диапазоне 1<a<N1<a<N, взаимно простое с NN (т.е. НОД(a,N)=1НОД(a,N)=1).  
    Если НОД(a,N)≠1НОД(a,N)=1, это уже делитель NN, и алгоритм завершается.
    

---

#### **2. Квантовая часть: поиск периода функции**

- **Определение функции:**  
    Рассмотрим функцию f(x)=axmod  Nf(x)=axmodN.  
    **Цель:** Найти наименьший период rr такой, что f(x+r)=f(x)f(x+r)=f(x).
    
- **Квантовый регистр:**  
    Используются два квантовых регистра:
    
    1. **Первый регистр (x):** Суперпозиция всех xx в диапазоне [0,Q)[0,Q), где QQ — степень двойки, Q≈N2Q≈N2.
        
    2. **Второй регистр (f(x)):** Хранит f(x)f(x).
        
- **Применение квантового преобразования Фурье (QFT):**  
    После вычисления f(x)f(x), QFT применяется к первому регистру. Это позволяет "усилить" значения, кратные периоду rr.
    
- **Измерение результата:**  
    Измерение первого регистра даёт значение yy, близкое к k⋅Qrk⋅rQ​ для некоторого целого kk.
    

---

#### **3. Классическая постобработка**

- **Нахождение периода rr:**  
    Используя измеренное yy, вычислите yQQy​ и приблизите его к дроби krrk​ с помощью **цепных дробей**.  
    Если rr чётный, переходите к следующему шагу. Если нет — повторите алгоритм с другим aa.
    

---

#### **4. Нахождение делителей NN**

- **Вычисление кандидатов:**  
    Если rr чётный, найдите:
    
    p=НОД(ar/2−1,N),q=НОД(ar/2+1,N).p=НОД(ar/2−1,N),q=НОД(ar/2+1,N).
    
    Если pp и qq — нетривиальные делители, алгоритм завершён. Иначе — повторите с другим aa.
    

---

### **Пример: факторизация N=15N=15**

1. Выберем a=7a=7 (взаимно просто с 15).
    
2. Функция f(x)=7xmod  15f(x)=7xmod15:  
    f(0)=1, f(1)=7, f(2)=4, f(3)=13, f(4)=1, ...f(0)=1,f(1)=7,f(2)=4,f(3)=13,f(4)=1,....  
    Период r=4r=4.
    
3. Вычисляем ar/2=72=49ar/2=72=49.  
    НОД(49−1,15)=НОД(48,15)=3НОД(49−1,15)=НОД(48,15)=3,  
    НОД(49+1,15)=НОД(50,15)=5НОД(49+1,15)=НОД(50,15)=5.  
    Результат: 15=3×515=3×5.